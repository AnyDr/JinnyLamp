# Эффект FIRE (fx_effects_fire.c)
Сделан на базе симуляцию “heat field” на логической сетке, так что по сути это не просто анимация, и полноценный огонь, и выглядит он просто очень круто! Лучшее что я создавал. Даже выбор ярче/тише делает меняет не яркость анимации, а реально разгоняет или почти тушит огонь. 


## 1) Назначение
Эффект “факельного” живого огня:
- несколько языков разной длины и толщины
- рваная асинхронная кромка (верх)
- “дыхание” и порывистый лёгкий ветерок (смена направления)
- редкие яркие “сполохи” внутри, без белой линии снизу
- редкие искры у основания (в т.ч. редкие холодные оттенки)

Цель визуала (ТЗ):
- низ: красно-оранжевый
- внутри: редкие жёлто-белые вспышки как “сполохи”
- верх: тоньше и гаснет
- редкие синие/голубые/зелёные искры у основания

## 2) Геометрия/размеры
- canvas: 48×16 (3 матрицы 16×16 по ширине, итого 768 LED)
- координаты и маппинг задаются в движке/матрице, FIRE рендерит в canvas-системе координат

## 3) Точки входа
- fx_fire_render(fx_ctx_t *ctx, uint32_t t_ms) - главный render
- прочие helper-функции в файле (static) формируют шум, форму языков, ветер, палитру, искры

## 4) Главные “ручки” тюнинга (compile-time)
В файле много #define FIRE_*. Практически полезные (часть):

### 4.1 Кромка (TIP)
- FIRE_TIP_AMP_Q8 - амплитуда “дыхания” кромки по вертикали
- FIRE_TIP_RISE_Q8, FIRE_TIP_FALL_Q8 - инерция подъёма/спада кромки (вязкость)

Смысл: TIP задаёт верхнюю границу (высоту по колонкам) и её неровность/дыхание.

### 4.2 Ветер (WIND)
Группа FIRE_WIND_* - скорость, плавность, развороты направления.
Смысл: смещение языков/шума по X во времени, “порывистый лёгкий ветерок”, не ураган.

### 4.3 Структура пламени (TONGUES / JETS / PETALS / ISLANDS)
Логические слои:
- языки (основной объём)
- “лепестки/петалы” (фактура, толщина, неоднородность)
- “островки” (неоднородность у основания и внутри объёма)

Важно: белый не должен быть “линией снизу”, он используется как редкие вспышки внутри.

### 4.4 Искры (SPARKS)
Группа FIRE_SPARK_* - количество/шанс/время жизни/цветовые акценты.
Смысл: редкие вкрапления у основания, иногда холодных оттенков.

## 5) Связь с brightness и speed_pct (факт логики проекта)
- brightness применяется глобально через софтверное scaling (драйвер/движок)
- speed_pct влияет на “скорость времени” эффекта через движок (base_step и множители)

## 6) Известные грабли при тюнинге
1) Если FIRE_TIP_AMP_Q8 перестаёт визуально влиять после некоторого значения:
   - вероятно упираемся в высоту H=16 и/или saturate/clamp координат
   - возможно TIP ограничивается другой маской/формой (верх “прибит” другим слоем)
2) Увеличение “зоны кромки” и “переходного градиента цвета” - разные вещи:
   - геометрия кромки = где заканчивается “объём”
   - толщина цветового перехода = как быстро палитра/фейд гасит цвет кверху
3) При изменении палитры не ломать инвариант:
   - верх должен быть тоньше и гаснуть
   - белый использовать как редкий сполох внутри, не как постоянный слой

## 7) Где искать логику в коде (ориентиры)
Поиск по файлу:
- "TIP" - формирование верхней границы
- "WIND" - смещение по X
- "SPARK" - искры
- "PETAL" / "ISLAND" - фактура/неоднородность
